import frappe

def update_all_course_links():
    try:
        # Log completo con todas las entradas antes y después
        log_data = """
        FELE/CRC/24/2023 -> EXP-PB-CRC-23-08
        FC/2023/33 -> EXP-PB-FC-23-08
        004/MED/05/2023 -> EXP-PB-MED-23-10
        005/MED/05/2023 -> EXP-PB-MED-23-11
        009/MED/05/2023 -> EXP-PB-MED-23-12
        021/MED/05/2023 -> EXP-PB-MED-23-13
        011/MED/09/2023 -> EXP-PB-MED-23-14
        017/MED/05/2023 -> EXP-PB-MED-23-15
        011/MED/05/2023 -> EXP-PB-MED-23-16
        9/MED/24/2023 -> EXP-PB-MED-23-17
        004/MED/49/2023 -> EXP-PB-MED-23-18
        014/MED/49/2023 -> EXP-PB-MED-23-19
        002/MED/49/2023 -> EXP-PB-MED-23-20
        008/MED/37/2023 -> EXP-PB-MED-23-21
        007/MED/37/2023 -> EXP-PB-MED-23-22
        021/MED/37/2023 -> EXP-PB-MED-23-23
        018/MED/42/2023 -> EXP-PB-MED-23-24
        018/MED/05/2024 -> EXP-PB-MED-23-25
        010/MED/09/2023 -> EXP-PB-MED-23-26
        013/MED/09/2023 -> EXP-PB-MED-23-27
        8/MED/24/2023 -> EXP-PB-MED-23-28
        10/MED/24/2023 -> EXP-PB-MED-23-29
        11/MED/24/2023 -> EXP-PB-MED-23-30
        038/MED/24/2023 -> EXP-PB-MED-23-31
        011/MED/47/2023 -> EXP-PB-MED-23-32
        009/MED/47/2023 -> EXP-PB-MED-23-33
        016/MED/09/2023 -> EXP-PB-MED-23-34
        021/MED/47/2023 -> EXP-PB-MED-23-35
        019/MED/47/2023 -> EXP-PB-MED-23-36
        001/MED/09/2023 -> EXP-PB-MED-23-37
        016/MED/47/2023 -> EXP-PB-MED-23-38
        020/MED/47/2023 -> EXP-PB-MED-23-39
        030/MED/47/2023 -> EXP-PB-MED-23-40
        031/MED/47/2023 -> EXP-PB-MED-23-41
        023/MED/49/2023 -> EXP-PB-MED-23-42
        021/MED/49/2023 -> EXP-PB-MED-23-43
        003/MED/09/2023 -> EXP-PB-MED-23-44
        013/MED/37/2023 -> EXP-PB-MED-23-45
        014/MED/37/2023 -> EXP-PB-MED-23-46
        009/MED/09/2023 -> EXP-PB-MED-23-47
        014/MED/09/2023 -> EXP-PB-MED-23-48
        020/MED/09/2023 -> EXP-PB-MED-23-49
        017/MED/24/2023 -> EXP-PB-MED-23-50
        018/MED/24/2023 -> EXP-PB-MED-23-51
        027/MED/24/2023 -> EXP-PB-MED-23-52
        032/MED/24/2023 -> EXP-PB-MED-23-53
        030/MED/24/2023 -> EXP-PB-MED-23-54
        046/MED/24/2023 -> EXP-PB-MED-23-55
        004/MED/42/2023 -> EXP-PB-MED-23-56
        008/MED/47/2023 -> EXP-PB-MED-23-57
        012/MED/47/2023 -> EXP-PB-MED-23-58
        017/MED/47/2023 -> EXP-PB-MED-23-59
        007/MED/09/2023 -> EXP-PB-MED-23-60
        017/MED/09/2023 -> EXP-PB-MED-23-61
        018/MED/09/2023 -> EXP-PB-MED-23-62
        022/MED/47/2023 -> EXP-PB-MED-23-63
        033/MED/47/2023 -> EXP-PB-MED-23-64
        018/MED/47/2023 -> EXP-PB-MED-23-65
        028/MED/47/2023 -> EXP-PB-MED-23-66
        027/MED/47/2023 -> EXP-PB-MED-23-67
        006/MED/34/2023 -> EXP-PB-MED-23-68
        018/MED/37/2023 -> EXP-PB-MED-23-69
        024/MED/37/2023 -> EXP-PB-MED-23-70
        028/MED/37/2023 -> EXP-PB-MED-23-71
        012/MED/09/2023 -> EXP-PB-MED-23-72
        022/MED/09/2023 -> EXP-PB-MED-23-73
        011/MED/42/2023 -> EXP-PB-MED-23-74
        012/MED/42/2023 -> EXP-PB-MED-23-75
        008/MED/09/2023 -> EXP-PB-MED-23-76
        021/MED/09/2023 -> EXP-PB-MED-23-77
        008/MED/34/2023 -> EXP-PB-MED-23-78
        010/MED/34/2023 -> EXP-PB-MED-23-79
        015/MED/42/2023 -> EXP-PB-MED-23-80
        025/MED/09/2023 -> EXP-PB-MED-23-81
        010/MED/47/2023 -> EXP-PB-MED-23-82
        011/MED/49/2023 -> EXP-PB-MED-23-83
        026/MED/09/2023 -> EXP-PB-MED-23-84
        027/MED/09/2023 -> EXP-PB-MED-23-85
        22/MED/05/2023 -> EXP-PB-MED-23-86
        7/MED/24/2023 -> EXP-PB-MED-23-87
        013/MED/24/2023 -> EXP-PB-MED-23-88
        015/MED/24/2023 -> EXP-PB-MED-23-89
        026/MED/24/2023 -> EXP-PB-MED-23-90
        031/MED/24/2023 -> EXP-PB-MED-23-91
        041/MED/24/2023 -> EXP-PB-MED-23-92
        017/MED/42/2023 -> EXP-PB-MED-23-93
        005/MED/49/2023 -> EXP-PB-MED-23-94
        016/MED/24/2023 -> EXP-PB-MED-23-95
        033/MED/24/2023 -> EXP-PB-MED-23-96
        035/MED/24/2023 -> EXP-PB-MED-23-97
        037/MED/24/2023 -> EXP-PB-MED-23-98
        040/MED/24/2023 -> EXP-PB-MED-23-99
        047/MED/24/2023 -> EXP-PB-MED-23-100
        057/MED/24/2023 -> EXP-PB-MED-23-101
        029/MED/47/2023 -> EXP-PB-MED-23-102
        007/MED/34/2023 -> EXP-PB-MED-23-103
        026/MED/47/2023 -> EXP-PB-MED-23-104
        025/MED/47/2023 -> EXP-PB-MED-23-105
        010/MED/49/2023 -> EXP-PB-MED-23-106
        020/MED/37/2023 -> EXP-PB-MED-23-107
        027/MED/37/2023 -> EXP-PB-MED-23-108
        007/MED/42/2023 -> EXP-PB-MED-23-109
        008/MED/42/2023 -> EXP-PB-MED-23-110
        056/MED/24/2023 -> EXP-PB-MED-23-111
        011/MED/34/2023 -> EXP-PB-MED-23-112
        012/MED/34/2023 -> EXP-PB-MED-23-113
        001/MED/42/2023 -> EXP-PB-MED-23-114
        009/MED/42/2023 -> EXP-PB-MED-23-115
        004/MED/09/2023 -> EXP-PB-MED-23-116
        024/MED/09/2023 -> EXP-PB-MED-23-117
        012/MED/37/2023 -> EXP-PB-MED-23-118
        004/MED/34/2023 -> EXP-PB-MED-23-119
        019/MED/34/2023 -> EXP-PB-MED-23-120
        015/MED/34/2023 -> EXP-PB-MED-23-121
        016/MED/34/2023 -> EXP-PB-MED-23-122
        018/MED/49/2023 -> EXP-PB-MED-23-123
        009/MED/34/2023 -> EXP-PB-MED-23-124
        017/MED/34/2023 -> EXP-PB-MED-23-125
        018/MED/34/2023 -> EXP-PB-MED-23-126
        025/MED/37/2023 -> EXP-PB-MED-23-127
        029/MED/37/2023 -> EXP-PB-MED-23-128
        2/CRC/09/2023 -> EXP-PB-CRC-23-09
        3/CRC/24/2023 -> EXP-PB-CRC-23-10
        56/CRC/47/2023 -> EXP-PB-CRC-23-11
        3/CRC/09/2023 -> EXP-PB-CRC-23-12
        2/CRC/34/2023 -> EXP-PB-CRC-23-13
        1/CRC/42/2023 -> EXP-PB-CRC-23-14
        6/CRC/09/2023 -> EXP-PB-CRC-23-15
        15/CRC/09/2023 -> EXP-PB-CRC-23-16
        29/CRC/37/2023 -> EXP-PB-CRC-23-17
        40/CRC/37/2023 -> EXP-PB-CRC-23-18
        30/CRC/24/2023 -> EXP-PB-CRC-23-19
        8/CRC/09/2023 -> EXP-PB-CRC-23-20
        34/CRC/09/2023 -> EXP-PB-CRC-23-21
        53/CRC/37/2023 -> EXP-PB-CRC-23-22
        119/CRC/47/2023 -> EXP-PB-CRC-23-23
        206/CRC/47/2023 -> EXP-PB-CRC-23-24
        8/CRC/34/2023 -> EXP-PB-CRC-23-25
        124/CRC/37/2023 -> EXP-PB-CRC-23-26
        4/CRC/42/2023 -> EXP-PB-CRC-23-27
        185/CRC/47/2023 -> EXP-PB-CRC-23-28
        48/CRC/05/2023 -> EXP-PB-CRC-23-29
        13/CRC/09/2023 -> EXP-PB-CRC-23-30
        4/CRC/34/2023 -> EXP-PB-CRC-23-31
        65/CRC/34/2023 -> EXP-PB-CRC-23-32
        52/CRC/37/2023 -> EXP-PB-CRC-23-33
        90/CRC/37/2023 -> EXP-PB-CRC-23-34
        120/CRC/37/2023 -> EXP-PB-CRC-23-35
        121/CRC/37/2023 -> EXP-PB-CRC-23-36
        122/CRC/37/2023 -> EXP-PB-CRC-23-37
        156/CRC/37/2023 -> EXP-PB-CRC-23-38
        5/CRC/42/2023 -> EXP-PB-CRC-23-39
        24/CRC/42/2023 -> EXP-PB-CRC-23-40
        21/CRC/49/2023 -> EXP-PB-CRC-23-41
        58/CRC/49/2023 -> EXP-PB-CRC-23-42
        63/CRC/49/2023 -> EXP-PB-CRC-23-43
        84/CRC/49/2023 -> EXP-PB-CRC-23-44
        87/CRC/49/2023 -> EXP-PB-CRC-23-45
        73/CRC/24/2023 -> EXP-PB-CRC-23-46
        7/CRC/42/2023 -> EXP-PB-CRC-23-47
        41/CRC/42/2023 -> EXP-PB-CRC-23-48
        118/CRC/47/2023 -> EXP-PB-CRC-23-49
        190/CRC/47/2023 -> EXP-PB-CRC-23-50
        215/CRC/47/2023 -> EXP-PB-CRC-23-51
        11/CRC/34/2023 -> EXP-PB-CRC-23-52
        69/CRC/34/2023 -> EXP-PB-CRC-23-53
        3/CRC/42/2023 -> EXP-PB-CRC-23-54
        8/CRC/42/2023 -> EXP-PB-CRC-23-55
        37/CRC/42/2023 -> EXP-PB-CRC-23-56
        53/CRC/05/2023 -> EXP-PB-CRC-23-57
        16/CRC/09/2023 -> EXP-PB-CRC-23-58
        89/CRC/37/2023 -> EXP-PB-CRC-23-59
        22/CRC/09/2023 -> EXP-PB-CRC-23-60
        30/CRC/42/2023 -> EXP-PB-CRC-23-61
        73/CRC/49/2023 -> EXP-PB-CRC-23-62
        33/CRC/09/2023 -> EXP-PB-CRC-23-63
        49/CRC/09/2023 -> EXP-PB-CRC-23-64
        70/CRC/37/2023 -> EXP-PB-CRC-23-65
        86/CRC/37/2023 -> EXP-PB-CRC-23-66
        97/CRC/24/2023 -> EXP-PB-CRC-23-67
        132/CRC/24/2023 -> EXP-PB-CRC-23-68
        167/CRC/47/2023 -> EXP-PB-CRC-23-69
        210/CRC/47/2023 -> EXP-PB-CRC-23-70
        35/CRC/09/2023 -> EXP-PB-CRC-23-71
        51/CRC/09/2023 -> EXP-PB-CRC-23-72
        98/CRC/09/2023 -> EXP-PB-CRC-23-73
        28/CRC/34/2023 -> EXP-PB-CRC-23-74
        2/CRC/42/2023 -> EXP-PB-CRC-23-75
        33/CRC/42/2023 -> EXP-PB-CRC-23-76
        3/CRC/34/2023 -> EXP-PB-CRC-23-77
        50/CRC/34/2023 -> EXP-PB-CRC-23-78
        64/CRC/34/2023 -> EXP-PB-CRC-23-79
        2/CRC/05/2023 -> EXP-PB-CRC-23-80
        38/CRC/05/2023 -> EXP-PB-CRC-23-81
        44/CRC/05/2023 -> EXP-PB-CRC-23-82
        52/CRC/05/2023 -> EXP-PB-CRC-23-83
        43/CRC/09/2023 -> EXP-PB-CRC-23-84
        50/CRC/09/2023 -> EXP-PB-CRC-23-85
        97/CRC/09/2023 -> EXP-PB-CRC-23-86
        77/CRC/37/2023 -> EXP-PB-CRC-23-87
        159/CRC/47/2023 -> EXP-PB-CRC-23-88
        205/CRC/47/2023 -> EXP-PB-CRC-23-89
        75/CRC/09/2023 -> EXP-PB-CRC-23-90
        127/CRC/09/2023 -> EXP-PB-CRC-23-91
        135/CRC/37/2023 -> EXP-PB-CRC-23-92
        13/CRC/34/2023 -> EXP-PB-CRC-23-93
        22/CRC/34/2023 -> EXP-PB-CRC-23-94
        26/CRC/49/2023 -> EXP-PB-CRC-23-95
        33/CRC/34/2023 -> EXP-PB-CRC-23-96
        40/CRC/34/2023 -> EXP-PB-CRC-23-97
        144/CRC/47/2023 -> EXP-PB-CRC-23-98
        45/CRC/34/2023 -> EXP-PB-CRC-23-99
        77/CRC/49/2023 -> EXP-PB-CRC-23-100
        3/CRC/37/2023 -> EXP-PB-CRC-23-101
        76/CRC/37/2023 -> EXP-PB-CRC-23-102
        20/CRC/34/2023 -> EXP-PB-CRC-23-103
        91/CRC/37/2023 -> EXP-PB-CRC-23-104
        123/CRC/37/2023 -> EXP-PB-CRC-23-105
        148/CRC/37/2023 -> EXP-PB-CRC-23-106
        125/CRC/24/2023 -> EXP-PB-CRC-23-107
        26/CRC/42/2023 -> EXP-PB-CRC-23-108
        153/CRC/37/2023 -> EXP-PB-CRC-23-109
        199/CRC/24/2023 -> EXP-PB-CRC-23-110
        20/CRC/42/2023 -> EXP-PB-CRC-23-111
        39/CRC/42/2023 -> EXP-PB-CRC-23-112
        25/CRC/49/2023 -> EXP-PB-CRC-23-113
        5/CRC/05/2023 -> EXP-PB-CRC-23-114
        37/CRC/49/2023 -> EXP-PB-CRC-23-115
        51/CRC/49/2023 -> EXP-PB-CRC-23-116
        13/CRC/05/2023 -> EXP-PB-CRC-23-117
        20/CRC/05/2023 -> EXP-PB-CRC-23-118
        38/CRC/49/2023 -> EXP-PB-CRC-23-119
        32/CRC/42/2023 -> EXP-PB-CRC-23-120
        35/CRC/42/2023 -> EXP-PB-CRC-23-121
        86/CRC/49/2023 -> EXP-PB-CRC-23-122
        102/CRC/49/2023 -> EXP-PB-CRC-23-123
        25/CRC/42/2023 -> EXP-PB-CRC-23-124
        31/CRC/42/2023 -> EXP-PB-CRC-23-125
        59/CRC/24/2023 -> EXP-PB-CRC-23-126
        75/CRC/47/2023 -> EXP-PB-CRC-23-127
        103/CRC/47/2023 -> EXP-PB-CRC-23-128
        62/CRC/24/2023 -> EXP-PB-CRC-23-129
        121/CRC/47/2023 -> EXP-PB-CRC-23-130
        98/CRC/24/2023 -> EXP-PB-CRC-23-131
        171/CRC/47/2023 -> EXP-PB-CRC-23-132
        110/CRC/24/2023 -> EXP-PB-CRC-23-133
        143/CRC/24/2023 -> EXP-PB-CRC-23-134
        135/CRC/47/2023 -> EXP-PB-CRC-23-135
        25/CRC/05/2023 -> EXP-PB-CRC-23-136
        133/CRC/24/2023 -> EXP-PB-CRC-23-137
        171/CRC/24/2023 -> EXP-PB-CRC-23-138
        162/CRC/24/2023 -> EXP-PB-CRC-23-139
        163/CRC/24/2023 -> EXP-PB-CRC-23-140
        164/CRC/24/2023 -> EXP-PB-CRC-23-141
        167/CRC/24/2023 -> EXP-PB-CRC-23-142
        195/CRC/24/2023 -> EXP-PB-CRC-23-143
        19/CRC/42/2023 -> EXP-PB-CRC-23-144
        6/CRC/42/2023 -> EXP-PB-CRC-23-145
        21/CRC/42/2023 -> EXP-PB-CRC-23-146
        12/CRC/34/2023 -> EXP-PB-CRC-23-147
        21/CRC/34/2023 -> EXP-PB-CRC-23-148
        6/CRC/05/2023 -> EXP-PB-CRC-23-149
        14/CRC/05/2023 -> EXP-PB-CRC-23-150
        2/CRC/47/2024 -> EXP-PB-CRC-23-151
        5/CRC/47/2024 -> EXP-PB-CRC-23-152
        26/CRC/47/2023 -> EXP-PB-CRC-23-153
        27/CRC/47/2023 -> EXP-PB-CRC-23-154
        74/CRC/47/2023 -> EXP-PB-CRC-23-155
        117/CRC/47/2023 -> EXP-PB-CRC-23-156
        120/CRC/47/2023 -> EXP-PB-CRC-23-157
        168/CRC/47/2023 -> EXP-PB-CRC-23-158
        207/CRC/47/2023 -> EXP-PB-CRC-23-159
        122/CRC/47/2023 -> EXP-PB-CRC-23-160
        29/CRC/34/2023 -> EXP-PB-CRC-23-161
        37/CRC/05/2023 -> EXP-PB-CRC-23-162
        169/CRC/47/2023 -> EXP-PB-CRC-23-163
        170/CRC/47/2023 -> EXP-PB-CRC-23-164
        172/CRC/47/2023 -> EXP-PB-CRC-23-165
        211/CRC/47/2023 -> EXP-PB-CRC-23-166
        29/CRC/05/2023 -> EXP-PB-CRC-23-167
        45/CRC/05/2023 -> EXP-PB-CRC-23-168
        182/CRC/47/2023 -> EXP-PB-CRC-23-169
        208/CRC/47/2023 -> EXP-PB-CRC-23-170
        34/CRC/34/2023 -> EXP-PB-CRC-23-171
        51/CRC/05/2023 -> EXP-PB-CRC-23-172
        OFI/09/2023/23/9 -> EXP-PB-OFI-23-01
        OFI/09/2023/19/2 -> EXP-PB-OFI-23-02
        OFI/09/2023/19/6 -> EXP-PB-OFI-23-03
        OFI/09/2023/19/4 -> EXP-PB-OFI-23-04
        OFI/09/2023/19/9 -> EXP-PB-OFI-23-05
        OFI/09/2023/19/12 -> EXP-PB-OFI-23-06
        OFI/09/2023/21/5 -> EXP-PB-OFI-23-07
        011/MED/37/2023 -> EXP-PB-MED-23-129
        006/MED/37/2023 -> EXP-PB-MED-23-130
        003/MED/34/2023 -> EXP-PB-MED-23-131
        021/MED/34/2023 -> EXP-PB-MED-23-132
        015/MED/05/2023 -> EXP-PB-MED-23-133
        015/MED/09/2023 -> EXP-PB-MED-23-134
        003/MED/42/2023 -> EXP-PB-MED-23-135
        61/MED/24/2023 -> EXP-PB-MED-23-136
        058/MED/24/2023 -> EXP-PB-MED-23-137
        060/MED/24/2023 -> EXP-PB-MED-23-138
        039/MED/24/2023 -> EXP-PB-MED-23-139
        023/MED/09/2023 -> EXP-PB-MED-23-140
        019/MED/09/2023 -> EXP-PB-MED-23-141
        002/MED/09/2023 -> EXP-PB-MED-23-142
        019/MED/05/2023 -> EXP-PB-MED-23-143
        016/MED/05/2023 -> EXP-PB-MED-23-144
        013/MED/05/2023 -> EXP-PB-MED-23-145
        003/MED/05/2023 -> EXP-PB-MED-23-146
        SFCL3/00021 -> EXP-PB-FC-23-09
        SFCL1/00015 -> EXP-PB-FC-23-10
        PCD/2023/21 -> EXP-PB-PCD-23-03
        PCD/2023/18 -> EXP-PB-PCD-23-04
        PCD/2023/13 -> EXP-PB-PCD-23-05
        PCD/2023/11 -> EXP-PB-PCD-23-06
        FCC99/2023/104/46 -> EXP-PB-FC-23-11
        FCC98/2023/350/03 -> EXP-PB-FC-23-12
        FCC98/2023/342/03 -> EXP-PB-FC-23-13
        FCC98/2023/335/03 -> EXP-PB-FC-23-14
        FCC98/2023/328/03 -> EXP-PB-FC-23-15
        FCC98/2023/327/03 -> EXP-PB-FC-23-16
        FCC98/2023/316/03 -> EXP-PB-FC-23-17
        FCC98/2023/314/03 -> EXP-PB-FC-23-18
        FC/2023/67 -> EXP-PB-FC-23-19
        FC/2023/66 -> EXP-PB-FC-23-20
        FC/2023/65 -> EXP-PB-FC-23-21
        FC/2023/62 -> EXP-PB-FC-23-22
        FC/2023/61 -> EXP-PB-FC-23-23
        FC/2023/56 -> EXP-PB-FC-23-24
        FC/2023/39 -> EXP-PB-FC-23-25
        FC/2023/38 -> EXP-PB-FC-23-26
        FC/2023/37 -> EXP-PB-FC-23-27
        FC/2023/36 -> EXP-PB-FC-23-28
        FC/2023/34 -> EXP-PB-FC-23-29
        90/FOD/24/2023 -> EXP-PB-FOD-23-05
        89/FOD/09/2023 -> EXP-PB-FOD-23-06
        86/FOD/09/2023 -> EXP-PB-FOD-23-07
        84/FOD/05/2023 -> EXP-PB-FOD-23-08
        83/FOD/05/2023 -> EXP-PB-FOD-23-09
        8/FOD/24/2023 -> EXP-PB-FOD-23-10
        76/FOD/05/2023 -> EXP-PB-FOD-23-11
        74/FOD/05/2023 -> EXP-PB-FOD-23-12
        73/FOD/05/2023 -> EXP-PB-FOD-23-13
        7/FOD/24/2023 -> EXP-PB-FOD-23-14
        60/FOD/37/2023 -> EXP-PB-FOD-23-15
        6/FOD/24/2023 -> EXP-PB-FOD-23-16
        58/FOD/37/2023 -> EXP-PB-FOD-23-17
        57/FOD/37/2023 -> EXP-PB-FOD-23-18
        55/FOD/24/2023 -> EXP-PB-FOD-23-19
        54/FOD/37/2023 -> EXP-PB-FOD-23-20
        54/FOD/24/2023 -> EXP-PB-FOD-23-21
        53/FOD/37/2023 -> EXP-PB-FOD-23-22
        53/FOD/24/2023 -> EXP-PB-FOD-23-23
        52/FOD/49/2023 -> EXP-PB-FOD-23-24
        50/FOD/40/2023 -> EXP-PB-FOD-23-25
        5/FOD/24/2023 -> EXP-PB-FOD-23-26
        45/FOD/49/2023 -> EXP-PB-FOD-23-27
        45/FOD/34/2023 -> EXP-PB-FOD-23-28
        44/FOD/49/2023 -> EXP-PB-FOD-23-29
        4/FOD/40/2023 -> EXP-PB-FOD-23-30
        4/FOD/24/2023 -> EXP-PB-FOD-23-31
        36/FOD/40/2023 -> EXP-PB-FOD-23-32
        36/FOD/34/2023 -> EXP-PB-FOD-23-33
        35/FOD/40/2023 -> EXP-PB-FOD-23-34
        35/FOD/34/2023 -> EXP-PB-FOD-23-35
        32/FOD/34/2023 -> EXP-PB-FOD-23-36
        31/FOD/34/2023 -> EXP-PB-FOD-23-37
        30/FOD/34/2023 -> EXP-PB-FOD-23-38
        3/FOD/40/2023 -> EXP-PB-FOD-23-39
        28/FOD/09/2023 -> EXP-PB-FOD-23-40
        25/FOD/09/2023 -> EXP-PB-FOD-23-41
        24/FOD/09/2023 -> EXP-PB-FOD-23-42
        23/FOD/09/2023 -> EXP-PB-FOD-23-43
        22/FOD/09/2023 -> EXP-PB-FOD-23-44
        163/FOD/47/2023 -> EXP-PB-FOD-23-45
        16/FOD/24/2023 -> EXP-PB-FOD-23-46
        15/FOD/42/2023 -> EXP-PB-FOD-23-47
        145/FOD/47/2023 -> EXP-PB-FOD-23-48
        144/FOD/24/2023 -> EXP-PB-FOD-23-49
        14/FOD/24/2023 -> EXP-PB-FOD-23-50
        136/FOD/37/2023 -> EXP-PB-FOD-23-51
        136/FOD/24/2023 -> EXP-PB-FOD-23-52
        135/FOD/24/2023 -> EXP-PB-FOD-23-53
        132/FOD/24/2023 -> EXP-PB-FOD-23-54
        131/FOD/47/2023 -> EXP-PB-FOD-23-55
        130/FOD/47/2023 -> EXP-PB-FOD-23-56
        13/FOD/24/2023 -> EXP-PB-FOD-23-57
        129/FOD/47/2023 -> EXP-PB-FOD-23-58
        123/FOD/37/2023 -> EXP-PB-FOD-23-59
        122/FOD/37/2023 -> EXP-PB-FOD-23-60
        121/FOD/37/2023 -> EXP-PB-FOD-23-61
        120/FOD/37/2023 -> EXP-PB-FOD-23-62
        119/FOD/37/2023 -> EXP-PB-FOD-23-63
        118/FOD/37/2023 -> EXP-PB-FOD-23-64
        117/FOD/37/2023 -> EXP-PB-FOD-23-65
        116/FOD/47/2023 -> EXP-PB-FOD-23-66
        115/FOD/47/2023 -> EXP-PB-FOD-23-67
        114/FOD/47/2023 -> EXP-PB-FOD-23-68
        113/FOD/47/2023 -> EXP-PB-FOD-23-69
        103/FOD/09/2023 -> EXP-PB-FOD-23-70
        B248819AF -> EXP-PV-BON-24-42
        E-2023-100014 -> EXP-PB-DES-23-133
        E-2023-100013 -> EXP-PB-DES-23-134
        EXP-PB-BON-24-01 -> EXP-PB-BON-24-07
        EXP-PV-BON-24-00 -> EXP-PV-BON-24-43
        EXP-PV-BON-24-01 -> EXP-PV-BON-24-44
        EXP-PV-BON-24-02 -> EXP-PV-BON-24-45
        EXP-PV-BON-24-03 -> EXP-PV-BON-24-46
        EXP-PB-CRC-24-00 -> EXP-PB-CRC-24-06
        FPR14/2024/94/03 -> EXP-PV-ARR-24-11
        F240019MC -> EXP-PB-EST-24-13
        F240034MC -> EXP-PB-EST-24-14
        EOI/2022/SAG_01/000032 -> EXP-PB-EOI-22-03
        E-2023-100024 -> EXP-PB-DES-23-135
        2023C/00016 -> EXP-PB-OCP-23-46
        ARR/UCAM/24 -> EXP-PV-ARR-24-12
        EXP-PV-ARR-24-00 -> EXP-PV-ARR-24-13
        FFI15/2024/47 -> EXP-PB-OCP-24-47
        FNS15/2024/70 -> EXP-PB-OCP-24-48
        EXP-PB--24-00 -> EXP-PB-FC-24-03
        E‐2023‐300396 -> EXP-PB-DES-23-136
        E‐2023‐300392 -> EXP-PB-DES-23-137
        E‐2023‐300397 -> EXP-PB-DES-23-138
        RSKC23/00089 -> EXP-PB-EST-24-15
        2023NC/00017 -> EXP-PB-OCP-23-49
        PB-MPR-2024-004234 -> EXP-PB-MPR-24-03
        zxzxzx -> EXP-PV-BON-24-47
        E‐2023‐300091 -> EXP-PB-DES-23-139
        FNS15/2024/61 -> EXP-PB-OCP-24-50
        FNS15/2024/65 -> EXP-PB-OCP-24-51
        FNA15/2024/10 -> EXP-PB-OCP-24-52
        PL-2024-63 -> EXP-PB-OCP-24-53
        AC-2023-1752 -> EXP-PB-DES-23-140
        AC-2023-1566 -> EXP-PB-DES-23-141
        AC-2023-1546 -> EXP-PB-DES-23-142
        AC-2024-7435 -> EXP-PB-DES-24-143
        FFS15/2024/121 -> EXP-PB-OCP-24-54
        PR-2024-256 -> EXP-PB-DES-24-144
        PR-2024-253 -> EXP-PB-DES-24-145
        FNI15/2024/33 -> EXP-PB-OCP-24-55
        FNS15/2024/63 -> EXP-PB-OCP-24-56
        FNS15/2024/66 -> EXP-PB-OCP-24-57
        PR-2024-48 -> EXP-PB-DES-24-146
        PR-2024-52 -> EXP-PB-DES-24-147
        RSKC23/00132 -> EXP-PB-EST-24-16
        RSKB23/00076 -> EXP-PB-EST-24-17
        RSKC23/00260 -> EXP-PB-EST-24-18
        RSKC23/00281 -> EXP-PB-EST-24-19
        UCAM/ALMERIA/2024/ -> EXP-PV-ARR-24-14
        23/2024/JC/0035 -> EXP-PB-DES-24-148
        ALM/ARR/2024 -> EXP-PV-ARR-24-15
        FFS15/2024/125 -> EXP-PB-OCP-24-58
        FFS15/2024/120 -> EXP-PB-OCP-24-59
        FFS15/2024/111 -> EXP-PB-OCP-24-60
        FFS15/2024/107 -> EXP-PB-OCP-24-61
        FFE15/2024/2 -> EXP-PB-OCP-24-62
        E-2023-300398 -> EXP-PB-DES-23-149
        FFA15/2024/18 -> EXP-PB-OCP-24-63
        04/2024/JC/0023 -> EXP-PB-DES-24-150
        RSKB23/00067 -> EXP-PB-EST-24-20
        AC-2024-6027 -> EXP-PB-DES-24-151
        AC-2024-6065 -> EXP-PB-DES-24-152
        AC-2024-6030 -> EXP-PB-DES-24-153
        AC-2024-6028 -> EXP-PB-DES-24-154
        AC-2024-6025 -> EXP-PB-DES-24-155
        AC-2024-6064 -> EXP-PB-DES-24-156
        AC-2024-6059 -> EXP-PB-DES-24-157
        AC-2024-6061 -> EXP-PB-DES-24-158
        PL-2024-62 -> EXP-PB-OCP-24-64
        MUR/ARR/2024 -> EXP-PV-ARR-24-16
        AC-2024-7434 -> EXP-PB-DES-24-159
        AC-2024-6063 -> EXP-PB-DES-24-160
        PL-2023-130 -> EXP-PB-OCP-23-65
        PL-2023-130/2 -> EXP-PB-OCP-23-66
        PL-2023-130/1 -> EXP-PB-OCP-23-67
        PL-2023-129/3 -> EXP-PB-OCP-23-68
        PL-2023-129/2 -> EXP-PB-OCP-23-69
        PL-2023-129/4 -> EXP-PB-OCP-23-70
        PL-2022-191/1 -> EXP-PB-OCP-22-71
        PL-2022-191/2 -> EXP-PB-OCP-22-72
        PL-2022-192/12 -> EXP-PB-OCP-22-73
        PL-2022-192/13 -> EXP-PB-OCP-22-74
        PL-2022-192/14 -> EXP-PB-OCP-22-75
        PL-2022-192/15 -> EXP-PB-OCP-22-76
        PL-2022-192/16 -> EXP-PB-OCP-22-77
        PL-2022-192/17 -> EXP-PB-OCP-22-78
        PL-2022-192/18 -> EXP-PB-OCP-22-79
        PL-2022-192/19 -> EXP-PB-OCP-22-80
        PL-2022-192/2 -> EXP-PB-OCP-22-81
        PL-2022-192/20 -> EXP-PB-OCP-22-82
        PL-2022-192/21 -> EXP-PB-OCP-22-83
        PL-2022-192/6 -> EXP-PB-OCP-22-84
        PL-2022-192/7 -> EXP-PB-OCP-22-85
        PL-2022-192/9 -> EXP-PB-OCP-22-86
        E‐2023‐301357 -> EXP-PB-DES-23-161
        E‐2023‐300786 -> EXP-PB-DES-23-162
        E‐2023‐300820 -> EXP-PB-DES-23-163
        RSKC23/00101 -> EXP-PB-EST-24-21
        E‐2023‐300796 -> EXP-PB-DES-23-164
        E-2023-100005 -> EXP-PB-DES-23-165
        E-2023-300805 -> EXP-PB-DES-23-166
        E-2023-300809 -> EXP-PB-DES-23-167
        E-2023-100008 -> EXP-PB-DES-23-168
        E-2023-100011 -> EXP-PB-DES-23-169
        E-2023-100007 -> EXP-PB-DES-23-170
        E-2023-100006 -> EXP-PB-DES-23-171
        E‐2023‐300793 -> EXP-PB-DES-23-172
        2023C/00004 -> EXP-PB-OCP-23-87
        2023NC/00003 -> EXP-PB-OCP-23-88
        E‐2023‐300812 -> EXP-PB-DES-23-173
        E-2023-300297 -> EXP-PB-DES-23-174
        E-2023-100004 -> EXP-PB-DES-23-175
        E‐2023‐300302 -> EXP-PB-DES-23-176
        E‐2023‐300303 -> EXP-PB-DES-23-177
        E‐2023‐300290 -> EXP-PB-DES-23-178
        14/2024/JC/0041 -> EXP-PB-DES-24-179
        E‐2023‐300298 -> EXP-PB-DES-23-180
        E‐2023‐300296 -> EXP-PB-DES-23-181
        E‐2023‐300295 -> EXP-PB-DES-23-182
        E‐2023‐300294 -> EXP-PB-DES-23-183
        E‐2023‐300293 -> EXP-PB-DES-23-184
        E‐2023‐300292 -> EXP-PB-DES-23-185
        E‐2023‐300291 -> EXP-PB-DES-23-186
        11/2024/JC/0028 -> EXP-PB-DES-24-187
        E‐2023‐300289 -> EXP-PB-DES-23-188
        E‐2023‐300311 -> EXP-PB-DES-23-189
        E‐2023‐300309 -> EXP-PB-DES-23-190
        E‐2023‐300313 -> EXP-PB-DES-23-191
        E‐2023‐300314 -> EXP-PB-DES-23-192
        E‐2023‐300315 -> EXP-PB-DES-23-193
        E‐2023‐300106 -> EXP-PB-DES-23-194
        E‐2023‐300104 -> EXP-PB-DES-23-195
        E‐2023‐300111 -> EXP-PB-DES-23-196
        E‐2023‐300110 -> EXP-PB-DES-23-197
        E‐2023‐300109 -> EXP-PB-DES-23-198
        E‐2023‐300108 -> EXP-PB-DES-23-199
        E‐2023‐300107 -> EXP-PB-DES-23-200
        E‐2023‐300105 -> EXP-PB-DES-23-201
        E‐2023‐300103 -> EXP-PB-DES-23-202
        E‐2023‐300102 -> EXP-PB-DES-23-203
        E‐2023‐300101 -> EXP-PB-DES-23-204
        E‐2023‐300100 -> EXP-PB-DES-23-205
        E‐2023‐300096 -> EXP-PB-DES-23-206
        E‐2023‐300095 -> EXP-PB-DES-23-207
        E‐2023‐300094 -> EXP-PB-DES-23-208
        E‐2023‐300093 -> EXP-PB-DES-23-209
        E‐2023‐300092 -> EXP-PB-DES-23-210
        E‐2023‐300090 -> EXP-PB-DES-23-211
        E‐2023‐300089 -> EXP-PB-DES-23-212
        E‐2023‐300088 -> EXP-PB-DES-23-213
        E-2023-300087 -> EXP-PB-DES-23-214
        E-2023-300086 -> EXP-PB-DES-23-215
        E‐2023‐300840 -> EXP-PB-DES-23-216
        E‐2023‐300838 -> EXP-PB-DES-23-217
        E‐2023‐300835 -> EXP-PB-DES-23-218
        E‐2023‐300832 -> EXP-PB-DES-23-219
        E‐2023‐300826 -> EXP-PB-DES-23-220
        E‐2023‐300823 -> EXP-PB-DES-23-221
        E‐2023‐300815 -> EXP-PB-DES-23-222
        E‐2023‐300814 -> EXP-PB-DES-23-223
        E‐2023‐300813 -> EXP-PB-DES-23-224
        E‐2023‐300811 -> EXP-PB-DES-23-225
        E‐2023‐300810 -> EXP-PB-DES-23-226
        E‐2023‐300808 -> EXP-PB-DES-23-227
        E‐2023‐300807 -> EXP-PB-DES-23-228
        E‐2023‐300806 -> EXP-PB-DES-23-229
        E‐2023‐300804 -> EXP-PB-DES-23-230
        E‐2023‐300803 -> EXP-PB-DES-23-231
        E‐2023‐300802 -> EXP-PB-DES-23-232
        E‐2023‐300801 -> EXP-PB-DES-23-233
        E‐2023‐300800 -> EXP-PB-DES-23-234
        E‐2023‐300799 -> EXP-PB-DES-23-235
        E‐2023‐300798 -> EXP-PB-DES-23-236
        E‐2023‐300795 -> EXP-PB-DES-23-237
        E‐2023‐300794 -> EXP-PB-DES-23-238
        E‐2023‐300792 -> EXP-PB-DES-23-239
        E‐2023‐300393 -> EXP-PB-DES-23-240
        E‐2023‐300791 -> EXP-PB-DES-23-241
        E‐2023‐300790 -> EXP-PB-DES-23-242
        E‐2023‐300789 -> EXP-PB-DES-23-243
        E‐2023‐300788 -> EXP-PB-DES-23-244
        E‐2023‐300787 -> EXP-PB-DES-23-245
        E‐2023‐300785 -> EXP-PB-DES-23-246
        E‐2023‐300784 -> EXP-PB-DES-23-247
        E‐2023‐300399 -> EXP-PB-DES-23-248
        E‐2023‐300395 -> EXP-PB-DES-23-249
        E‐2023‐300394 -> EXP-PB-DES-23-250
        E-2023-100029 -> EXP-PB-DES-23-251
        E-2023-100076 -> EXP-PB-DES-23-252
        E-2023-100075 -> EXP-PB-DES-23-253
        E-2023-100032 -> EXP-PB-DES-23-254
        E-2023-100030 -> EXP-PB-DES-23-255
        E-2023-100027 -> EXP-PB-DES-23-256
        E-2023-100026 -> EXP-PB-DES-23-257
        E-2023-100025 -> EXP-PB-DES-23-258
        E-2023-100023 -> EXP-PB-DES-23-259
        E-2023-100022 -> EXP-PB-DES-23-260
        E-2023-100020 -> EXP-PB-DES-23-261
        E-2023-100016 -> EXP-PB-DES-23-262
        F240036MC -> EXP-PB-EST-24-22
        B144335AA -> EXP-PV-BON-14-49
        PF/202300540 -> EXP-PB-DES-23-263
        23/2096 -> EXP-PB-LIC-23-15
        FO/PT032/24 -> EXP-PB-OCP-24-89
        RSKA23/00142 -> EXP-PB-EST-24-23
        B205652AF -> EXP-PV-BON-20-50
        B180025AA -> EXP-PV-BON-18-51
        B231242AA -> EXP-PV-BON-23-52
        B229426AA -> EXP-PV-BON-22-53
        B219547AE -> EXP-PV-BON-21-54
        B193099AE -> EXP-PV-BON-19-55
        B181909AG -> EXP-PV-BON-18-56
        B171567AF -> EXP-PV-BON-17-57
        B160155AA -> EXP-PV-BON-16-58
        B156778AC -> EXP-PV-BON-15-59
        B150072AA -> EXP-PV-BON-15-60
        B148899AA -> EXP-PV-BON-14-61
        B148864AA -> EXP-PV-BON-14-62
        41/MED/37/2023 -> EXP-PB-MED-24-09
        24/MED/49/2023 -> EXP-PB-MED-24-08
        FC/2024/63 -> EXP-PB-FC-24-07
        22/MED/34/2023 -> EXP-PB-MED-24-07
        66/MED/24/2023 -> EXP-PB-MED-24-06
        67/MED/24/2023 -> EXP-PB-MED-24-05
        38/MED/47/2023 -> EXP-PB-MED-24-04
        33/MED/05/2023 -> EXP-PB-MED-24-03
        29/MED/05/2023 -> EXP-PB-MED-24-02
        FC/2024/58 -> EXP-PB-FC-24-06
        47/MED/37/2023 -> EXP-PB-MED-24-01
        SFCL1_00012 -> EXP-PB-FC-24-05
        FC/2024/62 -> EXP-PB-FC-24-04
        145/FOD/7/10/2024 -> EXP-PB-FOD-24-02
        41/FOD/24/2023 -> EXP-PB-FOD-24-01
        PCD/2024/12 -> EXP-PB-PCD-24-02
        PCD/2024/16 -> EXP-PB-PCD-24-01
        """ 
        
        # Parsear el log de cambios
        log_entries = [line.strip() for line in log_data.split("\n") if "->" in line]
        updates = {}
        
        for entry in log_entries:
            before, after = map(str.strip, entry.split("->"))
            if "[Sin cambios]" not in after and "[Saltado" not in after:
                updates[before] = after

        # Obtener todas las acciones formativas de Course
        courses = frappe.get_all("Course", fields=["name", "expediente"])
        log_results = []  # Para almacenar los resultados del proceso

        for course in courses:
            if course["expediente"] in updates:
                old_expediente = course["expediente"]
                new_expediente = updates[old_expediente]
                
                try:
                    # Actualizar el campo expediente
                    frappe.db.set_value("Course", course["name"], "expediente", new_expediente)
                    log_results.append(f"{old_expediente} -> {new_expediente}")
                except Exception as e:
                    log_results.append(f"Error al actualizar {old_expediente}: {e}")
            else:
                log_results.append(f"{course['expediente']} -> [Sin cambios]")

        # Crear log consolidado
        frappe.log_error(
            title="Actualización masiva de expedientes en Course",
            message="Resultados de la actualización:\n" + "\n".join(log_results)
        )
        print("Actualización completada. Verifica el Error Log para más detalles.")
    
    except Exception as e:
        # Registrar errores globales
        frappe.log_error(title="Error en actualización masiva de Course", message=str(e))
        print(f"Error durante la actualización masiva: {e}")

